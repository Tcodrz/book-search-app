"use strict";(self.webpackChunkbook_search=self.webpackChunkbook_search||[]).push([[443],{4443:(W,d,n)=>{n.r(d),n.d(d,{BookSearchModule:()=>E});var b=n(6256),p=n(6019),a=n(7537),v=n(4596),Z=n(3907),k=n(5298),u=n(7593),m=n(7908),h=n(4753),g=n(2997),c=n(3414),o=n(3668),f=n(9007),C=n(6223),y=n(450),T=n(9463),M=n(9886),w=n(481),x=n(7043),A=n(8344);function B(e,i){1&e&&o._UZ(0,"p-progressSpinner")}let I=(()=>{class e{constructor(t){this.store=t,this.isLoading$=(0,g.of)(!1)}ngOnInit(){this.isLoading$=this.store.select("app").pipe((0,h.U)(t=>t.loading))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(f.yh))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-loader"]],decls:2,vars:3,consts:[[4,"ngIf"]],template:function(t,s){1&t&&(o.YNc(0,B,1,0,"p-progressSpinner",0),o.ALo(1,"async")),2&t&&o.Q6J("ngIf",o.lcZ(1,1,s.isLoading$))},directives:[p.O5,A.G],pipes:[p.Ov],encapsulation:2,changeDetection:0}),e})();function L(e,i){if(1&e&&(o.TgZ(0,"h2"),o._uU(1),o.qZA()),2&e){const t=o.oxw();o.xp6(1),o.hij("Hello, ",t.username,"")}}let O=(()=>{class e{constructor(){this.search=new o.vpe,this.searchForm=new a.cw({intitle:new a.NI(""),inauthor:new a.NI(""),inpublisher:new a.NI(""),subject:new a.NI("")}),this.subscription=new m.w0,this.username=""}set user(t){t&&(this.username=t.username)}set query(t){(function(e,i){for(const t in e)if(e[t]!==i[t])return!1;return!0})(t,this.searchForm.value)||this.searchForm.patchValue(t)}ngOnInit(){this.subscription=this.searchForm.valueChanges.pipe((0,T.b)(400)).subscribe(t=>{this.search.emit(t)})}ngOnDestroy(){this.subscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-search"]],inputs:{user:"user",query:"query"},outputs:{search:"search"},decls:26,vars:1,consts:[["pTemplate","header"],[3,"formGroup"],[1,"search-info"],[1,"pi","pi-search"],[1,"search-inputs"],[1,"p-inputgroup"],[1,"p-inputgroup-addon"],[1,"pi","pi-book"],["type","text","pInputText","","formControlName","intitle","placeholder","Title"],[1,"pi","pi-user"],["type","text","pInputText","","formControlName","inauthor","placeholder","Author"],[1,"pi","pi-users"],["type","text","pInputText","","formControlName","inpublisher","placeholder","Publisher"],[1,"pi","pi-list"],["type","text","pInputText","","formControlName","subject","placeholder","Category"],[1,"loader-container"]],template:function(t,s){1&t&&(o.TgZ(0,"p-fieldset"),o.YNc(1,L,2,1,"ng-template",0),o.TgZ(2,"form",1),o.TgZ(3,"div",2),o._UZ(4,"i",3),o.TgZ(5,"div"),o._uU(6,"You can combine any of the parameters to find books, but at least one is required"),o.qZA(),o.qZA(),o.TgZ(7,"div",4),o.TgZ(8,"div",5),o.TgZ(9,"span",6),o._UZ(10,"i",7),o.qZA(),o._UZ(11,"input",8),o.qZA(),o.TgZ(12,"div",5),o.TgZ(13,"span",6),o._UZ(14,"i",9),o.qZA(),o._UZ(15,"input",10),o.qZA(),o.TgZ(16,"div",5),o.TgZ(17,"span",6),o._UZ(18,"i",11),o.qZA(),o._UZ(19,"input",12),o.qZA(),o.TgZ(20,"div",5),o.TgZ(21,"span",6),o._UZ(22,"i",13),o.qZA(),o._UZ(23,"input",14),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(24,"div",15),o._UZ(25,"app-loader"),o.qZA()),2&t&&(o.xp6(2),o.Q6J("formGroup",s.searchForm))},directives:[M.p,w.jx,a._Y,a.JL,a.sg,a.Fj,x.o,a.JJ,a.u,I],styles:[".search-info[_ngcontent-%COMP%]{border:1px solid #6467f2;background:#dadafc;color:#404040;padding:.8rem .5rem;width:-moz-fit-content;width:fit-content;border-radius:10px;font-weight:500;display:flex;align-items:center}.search-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem;font-size:1.1rem;color:#326fd1}.search-inputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;flex-wrap:nowrap}.search-inputs[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:1rem 1rem 0 0}@media only screen and (max-width: 768px){.search-inputs[_ngcontent-%COMP%]{flex-wrap:wrap}.search-inputs[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:5px auto 0 0;width:100%}}"],changeDetection:0}),e})();var J=n(1698),U=n(4750);function N(e,i){if(1&e){const t=o.EpF();o.TgZ(0,"div",1),o.TgZ(1,"app-book-list",2),o.NdJ("bookSelected",function(r){return o.CHM(t),o.oxw().bookClicked(r)}),o.qZA(),o.TgZ(2,"button",3),o.NdJ("click",function(){return o.CHM(t),o.oxw().loadMore()}),o.qZA(),o.qZA()}if(2&e){const t=o.oxw();o.xp6(1),o.Q6J("books",t.books)("withButton",!1),o.xp6(1),o.Q6J("disabled",!t.loadMoreEnabled)}}let Q=(()=>{class e{constructor(){this.loadMoreEnabled=!0,this.load=new o.vpe,this.showDetails=new o.vpe,this.books=[]}set value(t){this.books=t||[]}loadMore(){this.load.emit(this.books.length-1)}bookClicked(t){this.showDetails.emit(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-results"]],inputs:{value:"value",loadMoreEnabled:"loadMoreEnabled"},outputs:{load:"load",showDetails:"showDetails"},decls:1,vars:1,consts:[["class","result-container",4,"ngIf"],[1,"result-container"],[3,"books","withButton","bookSelected"],["pButton","","type","button","label","load more","icon","pi pi-sync",1,"p-button-sm","p-button-secondary","load-more",3,"disabled","click"]],template:function(t,s){1&t&&o.YNc(0,N,3,3,"div",0),2&t&&o.Q6J("ngIf",s.books.length)},directives:[p.O5,J.J,U.Hq],styles:[".virtual-scroll-wrap[_ngcontent-%COMP%]{width:50%;margin:auto;min-width:380px}.load-more[_ngcontent-%COMP%]{margin-top:1rem}"],changeDetection:0}),e})();var D=n(397),F=n(4733);const P=[{path:"",component:(()=>{class e{constructor(t,s){this.store=t,this.booksSearchService=s,this.books=[],this.booksSubscription=new m.w0,this.totalItems=0,this.showModal=!1,this.loadMoreEnabled=!0}ngOnInit(){this.booksSubscription=this.store.select("books").subscribe(t=>{this.books=t.books,this.lastQuery=t.query,this.totalItems=t.totalItems,this.loadMoreEnabled=!!this.books&&this.books.length<this.totalItems}),this.user$=this.store.select("user").pipe((0,h.U)(t=>t.user))}ngOnDestroy(){this.booksSubscription.unsubscribe()}onSearch(t){const s=this.booksSearchService.buildQuery(t);this.booksSearchService.isValidQuery(s)?(this.store.dispatch(c.gg({payload:t})),this.store.dispatch(c.yC({payload:s}))):this.store.dispatch(c.ZH())}onLoadMore(t){t<this.totalItems-1&&this.store.dispatch(c.nR({payload:{index:t,lastQuery:this.lastQuery}}))}onShowBookDetails(t){this.book=t,this.showModal=!0}addBookToWishList(){this.store.dispatch(c.s3({payload:this.book})),this.hideModal()}hideModal(){this.showModal=!1}bookInWishList(){var t;return(null===(t=this.book)||void 0===t?void 0:t.id)?this.store.select("books").pipe((0,h.U)(s=>s.wishList.findIndex(r=>r.id===this.book.id)>=0)):(0,g.of)(!1)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(f.yh),o.Y36(C.Q))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-book-search"]],decls:8,vars:11,consts:[[1,"container"],[3,"user","query","search"],[3,"value","loadMoreEnabled","load","showDetails"],["key","wishlist-add"],[3,"value","showModal","bookInWishList","hide","addToWishList"]],template:function(t,s){1&t&&(o._UZ(0,"app-navbar"),o.TgZ(1,"div",0),o.TgZ(2,"app-search",1),o.NdJ("search",function(l){return s.onSearch(l)}),o.ALo(3,"async"),o.qZA(),o.TgZ(4,"app-results",2),o.NdJ("load",function(l){return s.onLoadMore(l)})("showDetails",function(l){return s.onShowBookDetails(l)}),o.qZA(),o._UZ(5,"p-toast",3),o.qZA(),o.TgZ(6,"app-book-modal",4),o.NdJ("hide",function(){return s.hideModal()})("addToWishList",function(){return s.addBookToWishList()}),o.ALo(7,"async"),o.qZA()),2&t&&(o.xp6(2),o.Q6J("user",o.lcZ(3,7,s.user$))("query",s.lastQuery),o.xp6(2),o.Q6J("value",s.books)("loadMoreEnabled",s.loadMoreEnabled),o.xp6(2),o.Q6J("value",s.book)("showModal",s.showModal)("bookInWishList",o.lcZ(7,9,s.bookInWishList())))},directives:[y.S,O,Q,D.FN,F.A],pipes:[p.Ov],styles:[""],changeDetection:0}),e})(),canActivate:[k.a]}];let R=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[u.Bz.forChild(P)],u.Bz]}),e})(),E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({providers:[],imports:[[p.ez,R,a.UX,b.Cl,Z.W,v.I]]}),e})()}}]);