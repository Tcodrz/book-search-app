"use strict";(self.webpackChunkbook_search=self.webpackChunkbook_search||[]).push([[490],{8490:(j,m,s)=>{s.r(m),s.d(m,{BookSearchModule:()=>D});var c=s(6019),r=s(7537),v=s(4596),C=s(5168),u=s(4753),t=s(3668),d=s(9007),h=s(7593);let Z=(()=>{class e{constructor(o,n){this.store=o,this.router=n}canActivate(){return this.store.select("user").pipe((0,u.U)(o=>!!o.isLoggedIn||this.router.parseUrl("/login")))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(d.yh),t.LFG(h.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=s(7908),p=s(3414),b=s(6223),M=s(450),y=s(9463),T=s(9886),f=s(481),k=s(7043),w=s(2997),_=s(8344);function O(e,i){1&e&&t._UZ(0,"p-progressSpinner")}let S=(()=>{class e{constructor(o){this.store=o,this.isLoading$=(0,w.of)(!1)}ngOnInit(){this.isLoading$=this.store.select("app").pipe((0,u.U)(o=>o.loading))}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(d.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-loader"]],decls:2,vars:3,consts:[[4,"ngIf"]],template:function(o,n){1&o&&(t.YNc(0,O,1,0,"p-progressSpinner",0),t.ALo(1,"async")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,n.isLoading$))},directives:[c.O5,_.G],pipes:[c.Ov],encapsulation:2,changeDetection:0}),e})();function A(e,i){if(1&e&&(t.TgZ(0,"h2"),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.hij(" Hello, ",o.username," ")}}let P=(()=>{class e{constructor(){this.search=new t.vpe,this.searchForm=new r.cw({intitle:new r.NI(""),inauthor:new r.NI(""),inpublisher:new r.NI(""),subject:new r.NI("")}),this.subscription=new g.w0,this.username=""}set user(o){o&&(this.username=o.username)}set query(o){(function(e,i){for(const o in e)if(e[o]!==i[o])return!1;return!0})(o,this.searchForm.value)||this.searchForm.patchValue(o)}ngOnInit(){this.subscription=this.searchForm.valueChanges.pipe((0,y.b)(400)).subscribe(o=>{this.search.emit(o)})}ngOnDestroy(){this.subscription.unsubscribe()}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-search"]],inputs:{user:"user",query:"query"},outputs:{search:"search"},decls:30,vars:1,consts:[["pTemplate","header"],[3,"formGroup"],[1,"search-info"],[1,"pi","pi-search"],[1,"search-inputs"],[1,"p-inputgroup"],[1,"p-inputgroup-addon"],[1,"pi","pi-book"],["type","text","pInputText","","formControlName","intitle","placeholder","Title"],[1,"pi","pi-user"],["type","text","pInputText","","formControlName","inauthor","placeholder","Author"],[1,"pi","pi-users"],["type","text","pInputText","","formControlName","inpublisher","placeholder","Publisher"],[1,"pi","pi-list"],["type","text","pInputText","","formControlName","subject","placeholder","Category"],[1,"loader-container"]],template:function(o,n){1&o&&(t.TgZ(0,"p-fieldset"),t.YNc(1,A,2,1,"ng-template",0),t.TgZ(2,"form",1),t.TgZ(3,"div",2),t._UZ(4,"i",3),t.TgZ(5,"div"),t._uU(6," You can combine any of the parameters to find books, but at least one is required "),t.qZA(),t.qZA(),t.TgZ(7,"div",4),t.TgZ(8,"div"),t.TgZ(9,"div",5),t.TgZ(10,"span",6),t._UZ(11,"i",7),t.qZA(),t._UZ(12,"input",8),t.qZA(),t.qZA(),t.TgZ(13,"div"),t.TgZ(14,"div",5),t.TgZ(15,"span",6),t._UZ(16,"i",9),t.qZA(),t._UZ(17,"input",10),t.qZA(),t.qZA(),t.TgZ(18,"div"),t.TgZ(19,"div",5),t.TgZ(20,"span",6),t._UZ(21,"i",11),t.qZA(),t._UZ(22,"input",12),t.qZA(),t.qZA(),t.TgZ(23,"div"),t.TgZ(24,"div",5),t.TgZ(25,"span",6),t._UZ(26,"i",13),t.qZA(),t._UZ(27,"input",14),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"div",15),t._UZ(29,"app-loader"),t.qZA()),2&o&&(t.xp6(2),t.Q6J("formGroup",n.searchForm))},directives:[T.p,f.jx,r._Y,r.JL,r.sg,r.Fj,k.o,r.JJ,r.u,S],styles:[".search-info[_ngcontent-%COMP%]{border:1px solid #6467f2;background:#dadafc;color:#404040;padding:.8rem .5rem;width:-moz-fit-content;width:fit-content;border-radius:10px;font-weight:500;display:flex;align-items:center}.search-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem;font-size:1.1rem;color:#326fd1}.search-inputs[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;flex-wrap:nowrap}.search-inputs[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:1rem 1rem 0 0}@media only screen and (max-width: 768px){.search-inputs[_ngcontent-%COMP%]{flex-wrap:wrap}.search-inputs[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:5px auto 0 0;width:100%}}"],changeDetection:0}),e})();var I=s(7583),L=s(4750),B=s(4115);function U(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",5),t.NdJ("click",function(){const l=t.CHM(o).$implicit;return t.oxw(2).bookClicked(l)}),t.TgZ(1,"div",6),t._UZ(2,"img",7),t.TgZ(3,"div"),t.TgZ(4,"h4"),t._uU(5),t.qZA(),t.TgZ(6,"p",8),t._uU(7),t.ALo(8,"arrayToString"),t.qZA(),t.TgZ(9,"p",9),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=i.$implicit;t.xp6(2),t.Q6J("src",null==o.volumeInfo.imageLinks?null:o.volumeInfo.imageLinks.smallThumbnail,t.LSH),t.xp6(3),t.Oqu(o.volumeInfo.title),t.xp6(2),t.hij(" ",t.lcZ(8,4,o.volumeInfo.authors)," "),t.xp6(3),t.hij("Language: ",o.volumeInfo.language,"")}}function J(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"p-virtualScroller",2),t.YNc(2,U,11,6,"ng-template",3),t.qZA(),t.TgZ(3,"button",4),t.NdJ("click",function(){return t.CHM(o),t.oxw().loadMore()}),t.qZA(),t.qZA()}if(2&e){const o=t.oxw();t.xp6(1),t.Q6J("value",o.books)("itemSize",o.books.length),t.xp6(2),t.Q6J("disabled",!o.loadMoreEnabled)}}let F=(()=>{class e{constructor(){this.loadMoreEnabled=!0,this.load=new t.vpe,this.showDetails=new t.vpe,this.books=[]}set value(o){this.books=o||[]}loadMore(){this.load.emit(this.books.length-1)}bookClicked(o){this.showDetails.emit(o)}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-results"]],inputs:{value:"value",loadMoreEnabled:"loadMoreEnabled"},outputs:{load:"load",showDetails:"showDetails"},decls:1,vars:1,consts:[["class","result-container",4,"ngIf"],[1,"result-container"],["scrollHeight","500px",3,"value","itemSize"],["pTemplate","item"],["pButton","","type","button","label","load more","icon","pi pi-sync",1,"p-button-sm","p-button-secondary","load-more",3,"disabled","click"],[1,"row-container",3,"click"],[1,"result-row"],["width","48",2,"display","inline-block","margin","2px 10px 2px 2px",3,"src"],[1,"authors"],[1,"language"]],template:function(o,n){1&o&&t.YNc(0,J,4,3,"div",0),2&o&&t.Q6J("ngIf",n.books.length)},directives:[c.O5,I.J,f.jx,L.Hq],pipes:[B.S],styles:[".p-orderlist .p-orderlist-controls{display:none}  div.p-virtualscroller-item{height:-moz-fit-content!important;height:fit-content!important;padding:11px 0 13px 35px}  div.p-virtualscroller-item:hover{background-color:#f5f9ff}@media only screen and (max-width: 768px){  div.p-virtualscroller-item{padding:11px 0 13px 12px}}.result-container[_ngcontent-%COMP%]{margin-top:1.5rem}.result-container[_ngcontent-%COMP%]   .row-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;cursor:pointer}.result-container[_ngcontent-%COMP%]   .row-container[_ngcontent-%COMP%]   .result-row[_ngcontent-%COMP%]{min-width:100%;display:flex;flex-direction:row;align-items:center;justify-content:flex-start}.result-container[_ngcontent-%COMP%]   .row-container[_ngcontent-%COMP%]   .result-row[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 10px 0 0}.result-container[_ngcontent-%COMP%]   .row-container[_ngcontent-%COMP%]   .result-row[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0}.result-container[_ngcontent-%COMP%]   .row-container[_ngcontent-%COMP%]   .result-row[_ngcontent-%COMP%]   .authors[_ngcontent-%COMP%]{margin:6px 0}.result-container[_ngcontent-%COMP%]   .row-container[_ngcontent-%COMP%]   .result-row[_ngcontent-%COMP%]   .language[_ngcontent-%COMP%]{margin:5px 0}.result-container[_ngcontent-%COMP%]   .row-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-self:baseline;padding-left:42px;min-width:max-content}.result-container[_ngcontent-%COMP%]   .row-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:-moz-fit-content;min-width:fit-content;margin:auto auto auto 1rem}.result-container[_ngcontent-%COMP%]   .load-more[_ngcontent-%COMP%]{margin-top:1rem}"],changeDetection:0}),e})();var q=s(4733);const N=[{path:"",component:(()=>{class e{constructor(o,n){this.store=o,this.booksSearchService=n,this.books=[],this.booksSubscription=new g.w0,this.totalItems=0,this.showModal=!1,this.loadMoreEnabled=!0}ngOnInit(){this.booksSubscription=this.store.select("books").subscribe(o=>{this.books=o.books,this.lastQuery=o.query,this.totalItems=o.totalItems,this.loadMoreEnabled=!!this.books&&this.books.length<this.totalItems}),this.user$=this.store.select("user").pipe((0,u.U)(o=>o.user))}ngOnDestroy(){this.booksSubscription.unsubscribe()}onSearch(o){const n=this.booksSearchService.buildQuery(o);this.booksSearchService.isValidQuery(n)?(this.store.dispatch(p.gg({payload:o})),this.store.dispatch(p.yC({payload:n}))):this.store.dispatch(p.ZH())}onLoadMore(o){o<this.totalItems-1&&this.store.dispatch(p.nR({payload:{index:o,lastQuery:this.lastQuery}}))}onShowBookDetails(o){this.book=o,this.showModal=!0}addBookToWishList(){this.store.dispatch(p.s3({payload:this.book})),this.hideModal()}hideModal(){this.showModal=!1}bookInWishList(){return this.store.select("books").pipe((0,u.U)(o=>o.wishList.includes(this.book)))}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(d.yh),t.Y36(b.Q))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-book-search"]],decls:7,vars:11,consts:[[1,"container"],[3,"user","query","search"],[3,"value","loadMoreEnabled","load","showDetails"],[3,"value","showModal","bookInWishList","hide","addToWishList"]],template:function(o,n){1&o&&(t._UZ(0,"app-navbar"),t.TgZ(1,"div",0),t.TgZ(2,"app-search",1),t.NdJ("search",function(l){return n.onSearch(l)}),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"app-results",2),t.NdJ("load",function(l){return n.onLoadMore(l)})("showDetails",function(l){return n.onShowBookDetails(l)}),t.qZA(),t.qZA(),t.TgZ(5,"app-book-modal",3),t.NdJ("hide",function(){return n.hideModal()})("addToWishList",function(){return n.addBookToWishList()}),t.ALo(6,"async"),t.qZA()),2&o&&(t.xp6(2),t.Q6J("user",t.lcZ(3,7,n.user$))("query",n.lastQuery),t.xp6(2),t.Q6J("value",n.books)("loadMoreEnabled",n.loadMoreEnabled),t.xp6(1),t.Q6J("value",n.book)("showModal",n.showModal)("bookInWishList",t.lcZ(6,9,n.bookInWishList())))},directives:[M.S,P,F,q.A],pipes:[c.Ov],styles:[""],changeDetection:0}),e})(),canActivate:[Z]}];let Q=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[h.Bz.forChild(N)],h.Bz]}),e})(),D=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[],imports:[[c.ez,Q,r.UX,C.W,v.I]]}),e})()}}]);